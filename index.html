<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naxxtra | Process Improvement Specialist</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- General Reset --- */
        :root {
            --primary-color: #5c94fc; /* Mario Blue */
            --accent-color: #3b82f6;
            --text-color: white;
        }

        /* MATRIX MODE VARIABLES (Triggered via Konami Code) */
        body.matrix-mode {
            --primary-color: #000000;
            --accent-color: #22c55e;
            --text-color: #22c55e;
            font-family: 'Courier New', monospace;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden; /* Lock scroll initially */
            background-color: #0f172a; /* Slate 900 */
            color: var(--text-color);
            font-family: 'Rajdhani', sans-serif;
            user-select: none;
            
            /* 1. CUSTOM ROCKET CURSOR */
            cursor: url("data:image/svg+xml,%3Csvg width='32' height='32' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M13.1096 2.06733C13.2662 2.14923 13.3934 2.27646 13.4753 2.43306L20.4753 15.8151C20.7303 16.3026 20.5418 16.9044 20.0543 17.1594C19.9079 17.236 19.7441 17.2758 19.5789 17.2758H16.7368L18.6315 21.0652C18.8773 21.5568 18.678 22.1545 18.1864 22.4003C18.0267 22.4802 17.8488 22.5126 17.671 22.4942L11.9999 21.909L6.32884 22.4942C5.78167 22.5507 5.29525 22.1499 5.23881 21.6028C5.22047 21.4249 5.25287 21.2471 5.33272 21.0874L7.22736 17.2758H4.38526C3.83297 17.2758 3.38526 16.8281 3.38526 16.2758C3.38526 16.1106 3.42503 15.9468 3.50162 15.8004L10.5016 2.43306C10.7566 1.94559 11.3584 1.75711 11.8459 2.01211C12.0025 2.09401 12.1297 2.22124 12.2116 2.37784L11.8053 2.16522L11.9778 2.075H12.0221L13.1096 2.06733Z' fill='white' stroke='black' stroke-width='1.5'/%3E%3C/svg%3E") 0 0, auto;
        }

        /* --- 2. CRT SCANLINE EFFECT --- */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.1) 50%,
                rgba(0,0,0,0.1)
            );
            background-size: 100% 4px;
            z-index: 999; /* Topmost */
            pointer-events: none;
            opacity: 0.6;
            animation: flicker 0.15s infinite;
        }

        @keyframes flicker {
            0% { opacity: 0.6; }
            50% { opacity: 0.65; }
            100% { opacity: 0.6; }
        }

        /* --- Game Intro Layer --- */
        #game-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 100; /* Top layer */
            background-color: var(--primary-color);
            transition: transform 0.8s cubic-bezier(0.77, 0, 0.175, 1);
        }

        body.matrix-mode #game-container {
            background-color: #000;
            border-bottom: 2px solid #0f0;
        }

        #game-canvas {
            width: 100%;
            height: 100%;
            display: block;
            image-rendering: pixelated;
        }

        .game-ui {
            position: absolute;
            font-family: 'Press Start 2P', cursive;
            text-align: center;
            pointer-events: none;
            text-shadow: 2px 2px 0 #000;
            width: 100%;
        }

        /* --- Particle Portfolio Layer --- */
        #portfolio-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in;
            z-index: 0;
            display: flex;
            justify-content: center;
            overflow-y: auto; 
            overflow-x: hidden;
            pointer-events: none;
            -webkit-overflow-scrolling: touch; /* Smooth scroll on iOS */
        }
        
        /* Custom Scrollbar */
        #portfolio-layer::-webkit-scrollbar { width: 8px; }
        #portfolio-layer::-webkit-scrollbar-track { background: transparent; }
        #portfolio-layer::-webkit-scrollbar-thumb { background: var(--accent-color); border-radius: 4px; }

        /* The Canvas for Particles */
        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; 
            pointer-events: none;
        }

        /* The Text Content (Under Particles) */
        #content-container {
            position: relative;
            z-index: 5;
            width: 100%;
            max-width: 900px;
            padding: 40px 20px 100px 20px;
            pointer-events: auto;
            text-align: left;
        }

        .cyber-text {
            font-family: 'Rajdhani', sans-serif;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .glitch-effect {
            text-shadow: 2px 2px 0px #ec4899, -2px -2px 0px #3b82f6;
        }

        /* Section Cards */
        .cyber-card {
            background: rgba(15, 23, 42, 0.85);
            border: 1px solid #334155;
            backdrop-filter: blur(4px);
            padding: 25px;
            margin-bottom: 30px;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        body.matrix-mode .cyber-card {
            background: rgba(0, 20, 0, 0.9);
            border-color: #0f0;
            color: #0f0;
        }

        .cyber-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 4px; height: 100%;
            background: var(--accent-color);
        }
        .cyber-card:hover {
            border-color: #60a5fa;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.15);
        }

        /* Experience Timeline */
        .timeline-item {
            border-left: 2px solid #334155;
            padding-left: 20px;
            margin-bottom: 25px;
            position: relative;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -6px; top: 5px;
            width: 10px; height: 10px;
            background: var(--accent-color);
            border-radius: 50%;
        }

        /* Tags */
        .tech-tag {
            display: inline-block;
            background: rgba(56, 189, 248, 0.1);
            color: #38bdf8;
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 4px;
            margin-right: 5px;
            margin-bottom: 5px;
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
        }
        body.matrix-mode .tech-tag {
            color: #0f0;
            background: rgba(0,255,0,0.1);
            border: 1px solid #0f0;
        }

        /* Social Grid */
        .social-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        @media (min-width: 768px) {
            .social-grid { grid-template-columns: repeat(4, 1fr); }
        }

        .social-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid #334155;
            padding: 15px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
            text-decoration: none;
            color: #cbd5e1;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
        }
        .social-card:hover {
            transform: translateY(-2px);
            border-color: #38bdf8;
            background: rgba(56, 189, 248, 0.15);
            color: white;
        }

        /* Gravity Toggle Button */
        #gravity-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 50;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #gravity-btn:hover { background: #e11d48; border-color: #e11d48; }
        #gravity-btn.active { background: #22c55e; border-color: #22c55e; box-shadow: 0 0 20px #22c55e; }

        /* Typing Effect Cursor */
        .typing-cursor::after {
            content: '_';
            animation: blink 1s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        /* Active State */
        body.site-active { overflow: hidden; } 
        body.site-active #game-container { transform: translateY(-100%); }
        body.site-active #portfolio-layer { opacity: 1; pointer-events: auto; }
    </style>
</head>
<body>
    
    <!-- CRT Overlay -->
    <div class="scanlines"></div>

    <!-- === 1. RETRO GAME INTRO LAYER === -->
    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        <div class="game-ui" style="top: 40%;">
            <p class="text-xs md:text-sm text-yellow-300 animate-pulse">REACH THE FLAG TO ENTER</p>
        </div>
        <div class="game-ui" style="bottom: 20px;">
            <p class="text-[10px] text-white opacity-80">SPACE / TAP TO JUMP</p>
        </div>
    </div>

    <!-- === 2. INTERACTIVE PORTFOLIO LAYER === -->
    <div id="portfolio-layer">
        
        <!-- Canvas for Particles (Fixed Background) -->
        <canvas id="particle-canvas"></canvas>

        <!-- Magnet Gravity Button -->
        <button id="gravity-btn" title="Toggle Gravity">
            <i class="fa-solid fa-magnet text-xl"></i>
        </button>

        <!-- Main Content -->
        <div id="content-container">
            
            <!-- Header -->
            <header class="text-center mb-16 mt-10">
                <div class="inline-block border border-green-500 bg-green-500/10 px-3 py-1 rounded text-xs text-green-400 font-mono mb-4 tracking-widest">
                    SYSTEM UNLOCKED
                </div>
                <!-- Typing Effect Target -->
                <h1 id="hero-title" class="text-6xl md:text-8xl font-bold mb-4 cyber-text glitch-effect typing-cursor">
                    <!-- Text injected via JS -->
                </h1>
                <p id="hero-subtitle" class="text-xl md:text-2xl text-blue-300 font-light tracking-widest">
                    <!-- Text injected via JS -->
                </p>
                <div class="flex flex-wrap justify-center gap-2 mt-4 text-gray-400 text-sm">
                    <span><i class="fa-solid fa-location-dot mr-2"></i>London, UK</span>
                    <span class="mx-2">|</span>
                    <span><i class="fa-brands fa-amazon mr-2"></i>Amazon</span>
                    <span class="mx-2">|</span>
                    <span><i class="fa-solid fa-rocket mr-2"></i>Operations</span>
                </div>
            </header>

            <!-- About Section -->
            <div class="cyber-card">
                <h3 class="text-xl font-bold mb-4 text-purple-400 font-mono"><i class="fa-solid fa-user-astronaut mr-2"></i>PROFILE_SUMMARY</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    I'm driven by curiosity and a passion for finding smarter, more sustainable solutions. Whether it's optimizing operations, exploring trading strategies, or tapping into the potential of renewable energy, I thrive on turning challenges into opportunities.
                </p>
                <p class="text-gray-400 text-sm italic">
                    "Every challenge is an opportunity to learn, adapt, and leave things better than I found them."
                </p>
            </div>

            <!-- Experience Section -->
            <div class="cyber-card">
                <h3 class="text-xl font-bold mb-6 text-blue-400 font-mono"><i class="fa-solid fa-briefcase mr-2"></i>MISSION_LOGS (EXPERIENCE)</h3>
                
                <div class="timeline-item">
                    <div class="flex flex-wrap justify-between items-start mb-1">
                        <h4 class="text-lg font-bold">Process Improvement Specialist</h4>
                        <span class="text-xs bg-blue-900 text-blue-200 px-2 py-1 rounded">July 2025 - Present</span>
                    </div>
                    <div class="text-blue-400 text-sm mb-2">Amazon | Essex, UK</div>
                    <p class="text-gray-400 text-sm">Optimizing operational workflows and driving efficiency improvements in Amazon's fulfillment network.</p>
                </div>

                <div class="timeline-item">
                    <div class="flex flex-wrap justify-between items-start mb-1">
                        <h4 class="text-lg font-bold">Operations Management Intern</h4>
                        <span class="text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded">Jan 2025 - July 2025</span>
                    </div>
                    <div class="text-blue-400 text-sm mb-2">Amazon | London, UK</div>
                    <p class="text-gray-400 text-sm">Gained hands-on experience in large-scale operations management and supply chain logistics.</p>
                </div>

                <div class="timeline-item">
                    <div class="flex flex-wrap justify-between items-start mb-1">
                        <h4 class="text-lg font-bold">Founder</h4>
                        <span class="text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded">July 2024 - Present</span>
                    </div>
                    <div class="text-blue-400 text-sm mb-2">SOLARB Space | UK</div>
                    <p class="text-gray-400 text-sm mb-2">Managing diversified crypto portfolios, developing smart contracts, and designing tokenomics/DAOs.</p>
                    <div>
                        <span class="tech-tag">BLOCKCHAIN</span>
                        <span class="tech-tag">TRADING</span>
                        <span class="tech-tag">STRATEGY</span>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="flex flex-wrap justify-between items-start mb-1">
                        <h4 class="text-lg font-bold">Management Trainee</h4>
                        <span class="text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded">Dec 2022 - Feb 2023</span>
                    </div>
                    <div class="text-blue-400 text-sm mb-2">Morjim Castle Beach Resort | India</div>
                    <p class="text-gray-400 text-sm">Improved guest satisfaction by 15%, reduced room turnover by 20%, and utilized data analytics to boost operational efficiency by 30%.</p>
                </div>
            </div>

            <!-- Skills & Education Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                
                <!-- Education -->
                <div class="cyber-card">
                    <h3 class="text-xl font-bold mb-4 text-green-400 font-mono"><i class="fa-solid fa-graduation-cap mr-2"></i>TRAINING</h3>
                    
                    <div class="mb-4">
                        <h4 class="font-bold">MSc Operations Management</h4>
                        <p class="text-sm text-gray-400">Warwick Business School</p>
                        <p class="text-xs text-gray-500">2023 - 2024</p>
                    </div>

                    <div class="mb-4">
                        <h4 class="font-bold">BTech Aeronautical Engineering</h4>
                        <p class="text-sm text-gray-400">Amity University Mumbai</p>
                        <p class="text-xs text-gray-500">2018 - 2022</p>
                    </div>
                </div>

                <!-- Skills -->
                <div class="cyber-card">
                    <h3 class="text-xl font-bold mb-4 text-yellow-400 font-mono"><i class="fa-solid fa-microchip mr-2"></i>STATS & SKILLS</h3>
                    
                    <div class="mb-4">
                        <h5 class="text-xs font-bold text-gray-500 mb-2 uppercase">Core Competencies</h5>
                        <div class="flex flex-wrap">
                            <span class="tech-tag">IP Management</span>
                            <span class="tech-tag">Data Privacy</span>
                            <span class="tech-tag">SQL Essentials</span>
                            <span class="tech-tag">Project Mgmt</span>
                            <span class="tech-tag">Data Analytics</span>
                        </div>
                    </div>

                    <div>
                        <h5 class="text-xs font-bold text-gray-500 mb-2 uppercase">Languages</h5>
                        <div class="space-y-1 text-sm text-gray-300">
                            <div class="flex justify-between"><span>English</span> <span class="text-green-400">Professional</span></div>
                            <div class="flex justify-between"><span>Hindi</span> <span class="text-green-400">Professional</span></div>
                            <div class="flex justify-between"><span>Marathi</span> <span class="text-green-400">Native</span></div>
                            <div class="flex justify-between"><span>Japanese</span> <span class="text-yellow-400">Elementary</span></div>
                            <div class="flex justify-between"><span>German</span> <span class="text-yellow-400">Limited</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Social Links -->
            <h3 class="text-center text-gray-500 font-mono text-xs mb-4 mt-8">ESTABLISH_UPLINK</h3>
            <div class="social-grid">
                <a href="mailto:nakshatrapardeshi@gmail.com" class="social-card">
                    <i class="fa-solid fa-envelope text-red-400"></i>
                    <span>MAIL</span>
                </a>
                <a href="https://www.nakshatrapardeshi.com" target="_blank" class="social-card">
                    <i class="fa-solid fa-globe text-blue-400"></i>
                    <span>WEBSITE</span>
                </a>
                <a href="https://www.instagram.com/nakshatrapardeshi" target="_blank" class="social-card">
                    <i class="fa-brands fa-instagram text-pink-500"></i>
                    <span>INSTAGRAM</span>
                </a>
                <a href="https://uk.linkedin.com/in/nakshatrapardeshi" target="_blank" class="social-card">
                    <i class="fa-brands fa-linkedin text-blue-600"></i>
                    <span>LINKEDIN</span>
                </a>
                <a href="https://meta.ai/@nakshatrapardeshi" target="_blank" class="social-card">
                    <i class="fa-solid fa-brain text-purple-500"></i>
                    <span>META AI</span>
                </a>
                <a href="https://www.threads.com/@nakshatrapardeshi" target="_blank" class="social-card">
                    <i class="fa-brands fa-threads text-white"></i>
                    <span>THREADS</span>
                </a>
                <a href="https://medium.com/@nakshatrapardeshi" target="_blank" class="social-card">
                    <i class="fa-brands fa-medium text-white"></i>
                    <span>MEDIUM</span>
                </a>
                <a href="https://www.youtube.com/@nakshatrapardeshi" target="_blank" class="social-card">
                    <i class="fa-brands fa-youtube text-red-600"></i>
                    <span>YOUTUBE</span>
                </a>
            </div>

            <footer class="text-center text-gray-600 text-xs mt-12 mb-4 font-mono">
                TERMINAL SESSION ACTIVE // ID: NAXXTRA_V2.0
            </footer>

        </div>
    </div>

    <!-- === SCRIPTS === -->
    <script>
    (function() { // Start IIFE
        
        /* --- 5. AUDIO SYSTEM (Synthesizer) --- */
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        // Jump Sound (Quick low beep)
        function playJumpSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'square';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(600, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.1);
        }

        // Win Sound (Classic Melody)
        function playWinSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const notes = [523.25, 659.25, 783.99, 1046.50]; // C E G C
            const now = audioCtx.currentTime;
            
            notes.forEach((freq, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'triangle';
                osc.frequency.value = freq;
                
                gain.gain.setValueAtTime(0.1, now + i * 0.1);
                gain.gain.exponentialRampToValueAtTime(0.01, now + i * 0.1 + 0.2);
                
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start(now + i * 0.1);
                osc.stop(now + i * 0.1 + 0.3);
            });
        }

        // Firework Explosion Sound (Noise Buffer)
        function playExplosionSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            
            const bufferSize = audioCtx.sampleRate * 0.5; // 0.5 seconds
            const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);
            
            for (let i = 0; i < bufferSize; i++) {
                data[i] = Math.random() * 2 - 1;
            }

            const noise = audioCtx.createBufferSource();
            noise.buffer = buffer;
            
            const gain = audioCtx.createGain();
            gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            
            noise.connect(gain);
            gain.connect(audioCtx.destination);
            noise.start();
        }


        /* --- KONAMI CODE LISTENER --- */
        const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
        let konamiIndex = 0;
        document.addEventListener('keydown', (e) => {
            if (e.key === konamiCode[konamiIndex]) {
                konamiIndex++;
                if (konamiIndex === konamiCode.length) {
                    document.body.classList.toggle('matrix-mode');
                    konamiIndex = 0;
                }
            } else {
                konamiIndex = 0;
            }
        });

        /* =========================================
           PART 1: THE RETRO RUNNER GAME
           ========================================= */
        const gameCanvas = document.getElementById('game-canvas');
        const gCtx = gameCanvas.getContext('2d');
        const gameContainer = document.getElementById('game-container');
        
        let gameRunning = false;
        let gameWinSequence = false;
        let gameFrameId;
        
        // Game State
        const GAME_GRAVITY = 0.6;
        const JUMP = -12;
        let scroll = 0;
        
        // Firework System
        let fireworkParticles = [];
        
        // Birds System
        let birds = [];

        const hero = { x: 50, y: 0, w: 30, h: 30, dy: 0, grounded: false };
        const map = [
            {x: 400, w: 40, h: 40, t: 'box'},
            {x: 700, w: 30, h: 30, t: 'spike'},
            {x: 1100, w: 40, h: 60, t: 'box'},
            {x: 1400, w: 30, h: 30, t: 'spike'},
            {x: 1440, w: 30, h: 30, t: 'spike'},
            {x: 2000, w: 10, h: 200, t: 'flag'} // Finish
        ];

        function resizeGame() {
            gameCanvas.width = window.innerWidth;
            gameCanvas.height = window.innerHeight;
            if(!gameRunning && !gameWinSequence) hero.y = gameCanvas.height - 60 - hero.h;
        }
        window.addEventListener('resize', resizeGame);

        function initGame() {
            scroll = 0;
            hero.y = gameCanvas.height - 60 - hero.h;
            hero.dy = 0;
            gameRunning = true;
            gameWinSequence = false;
            fireworkParticles = [];
            birds = [];
            // Init birds
            for(let i=0; i<5; i++) {
                birds.push({
                    x: Math.random() * window.innerWidth + window.innerWidth,
                    y: Math.random() * 200 + 50,
                    speed: Math.random() * 2 + 1
                });
            }
            resizeGame();
            gameLoop();
        }
        
        class Firework {
            constructor(x, y, color) {
                this.x = x; this.y = y;
                this.size = Math.random() * 3 + 2;
                this.color = color;
                this.velocity = {
                    x: (Math.random() - 0.5) * 6,
                    y: (Math.random() - 0.5) * 6
                };
                this.life = 1.0;
                this.decay = Math.random() * 0.02 + 0.01;
            }
            draw(ctx) {
                ctx.globalAlpha = this.life;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1.0;
            }
            update() {
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                this.life -= this.decay;
            }
        }

        function spawnFirework(x, y) {
            playExplosionSound();
            const colors = ['#ef4444', '#f59e0b', '#3b82f6', '#10b981', '#ffffff'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            for(let i=0; i<20; i++) {
                fireworkParticles.push(new Firework(x, y, color));
            }
        }

        function gameLoop() {
            if (!gameRunning && !gameWinSequence) return;

            if (gameRunning) {
                // Update
                scroll += 5;
                hero.dy += GAME_GRAVITY;
                hero.y += hero.dy;
                
                // Floor
                if (hero.y + hero.h > gameCanvas.height - 60) {
                    hero.y = gameCanvas.height - 60 - hero.h;
                    hero.dy = 0;
                    hero.grounded = true;
                } else {
                    hero.grounded = false;
                }
                
                // Update Birds
                birds.forEach(b => {
                    b.x -= b.speed;
                    if(b.x < -50) {
                        b.x = gameCanvas.width + Math.random() * 500;
                        b.y = Math.random() * 200 + 50;
                    }
                });
            }

            const screenGround = gameCanvas.height - 60;

            // Collisions (Only run if game is active)
            if (gameRunning) {
                map.forEach(obj => {
                    let ox = obj.x - scroll;
                    if (hero.x < ox + obj.w && hero.x + hero.w > ox &&
                        hero.y + hero.h > screenGround - obj.h) {
                        if (obj.t === 'spike') {
                            scroll = 0; // Die
                            hero.y = screenGround - hero.h;
                        } else if (obj.t === 'box') {
                            scroll = 0; // Die
                        } else if (obj.t === 'flag') {
                            // WIN DETECTED
                            triggerWinSequence(obj, screenGround);
                        }
                    }
                });
            }

            // Draw Sky (Background)
            gCtx.fillStyle = document.body.classList.contains('matrix-mode') ? '#000' : '#5c94fc';
            gCtx.fillRect(0, 0, gameCanvas.width, gameCanvas.height);

            if(!document.body.classList.contains('matrix-mode')) {
                // Draw Sun
                gCtx.fillStyle = '#FDB813';
                gCtx.beginPath();
                gCtx.arc(gameCanvas.width - 100, 80, 40, 0, Math.PI * 2);
                gCtx.fill();
                gCtx.fillStyle = 'rgba(253, 184, 19, 0.3)';
                gCtx.beginPath();
                gCtx.arc(gameCanvas.width - 100, 80, 50, 0, Math.PI * 2);
                gCtx.fill();
                
                // Draw Birds
                gCtx.fillStyle = '#fff';
                birds.forEach(b => {
                    // Simple V shape
                    gCtx.beginPath();
                    // Use frame count to flap wings
                    const flap = Math.sin(Date.now() / 100) * 5;
                    gCtx.moveTo(b.x, b.y);
                    gCtx.lineTo(b.x - 10, b.y - 5 + flap);
                    gCtx.lineTo(b.x - 5, b.y);
                    gCtx.lineTo(b.x + 5, b.y - 5 + flap);
                    gCtx.lineTo(b.x, b.y);
                    gCtx.fill();
                });

                // Draw Trees (Parallax Background)
                const treeScroll = scroll * 0.5; 
                for(let i = 0; i < 40; i++) {
                    let tx = (i * 300) - treeScroll;
                    if(tx > -100 && tx < gameCanvas.width) {
                        const groundY = gameCanvas.height - 60;
                        gCtx.fillStyle = '#7c2d12'; 
                        gCtx.fillRect(tx + 15, groundY - 60, 20, 60);
                        gCtx.fillStyle = '#166534'; 
                        gCtx.fillRect(tx, groundY - 100, 50, 40); 
                        gCtx.fillStyle = '#15803d'; 
                        gCtx.fillRect(tx + 5, groundY - 120, 40, 30); 
                        gCtx.fillStyle = '#22c55e'; 
                        gCtx.fillRect(tx + 10, groundY - 130, 30, 20); 
                    }
                }
            } else {
                // Matrix Mode Background
                gCtx.fillStyle = '#0f0';
                gCtx.font = '14px monospace';
                for(let i=0; i<20; i++) {
                     gCtx.fillText(String.fromCharCode(0x30A0 + Math.random() * 96), (i*100 - scroll*0.5) % gameCanvas.width, Math.random() * gameCanvas.height);
                }
            }

            // Floor
            gCtx.fillStyle = document.body.classList.contains('matrix-mode') ? '#001100' : '#5D4037';
            gCtx.fillRect(0, gameCanvas.height - 60, gameCanvas.width, 60);
            gCtx.fillStyle = document.body.classList.contains('matrix-mode') ? '#0f0' : '#4CAF50';
            gCtx.fillRect(0, gameCanvas.height - 60, gameCanvas.width, 10);

            // Objects
            map.forEach(obj => {
                let ox = obj.x - scroll;
                if(ox > -100 && ox < gameCanvas.width) {
                    if(obj.t === 'box') {
                        gCtx.fillStyle = '#fbbf24'; gCtx.fillRect(ox, screenGround - obj.h, obj.w, obj.h);
                        gCtx.strokeStyle = '#b45309'; gCtx.strokeRect(ox, screenGround - obj.h, obj.w, obj.h);
                    } else if(obj.t === 'spike') {
                        gCtx.fillStyle = '#9ca3af';
                        gCtx.beginPath();
                        gCtx.moveTo(ox, screenGround);
                        gCtx.lineTo(ox + obj.w/2, screenGround - obj.h);
                        gCtx.lineTo(ox + obj.w, screenGround);
                        gCtx.fill();
                    } else if(obj.t === 'flag') {
                        gCtx.fillStyle = '#fff'; gCtx.fillRect(ox, screenGround - 200, 5, 200);
                        gCtx.fillStyle = 'red'; gCtx.fillRect(ox+5, screenGround-200, 40, 30);
                    }
                }
            });

            // Player
            const px = hero.x, py = hero.y;
            gCtx.fillStyle = '#ef4444'; // Hat
            gCtx.fillRect(px, py, 30, 10);
            gCtx.fillStyle = '#2563eb'; // Overalls
            gCtx.fillRect(px+5, py+10, 20, 20);
            gCtx.fillStyle = '#ffccaa'; // Face
            gCtx.fillRect(px+5, py+5, 20, 10);
            
            // Legs running animation
            if(hero.grounded) {
                const leg = Math.sin(scroll * 0.2) * 5;
                gCtx.fillStyle = '#451a03'; // Shoes
                gCtx.fillRect(px + 5 - leg, py + 25, 8, 5);
                gCtx.fillRect(px + 15 + leg, py + 25, 8, 5);
            } else {
                gCtx.fillStyle = '#451a03'; // Jump Shoes
                gCtx.fillRect(px + 2, py + 25, 8, 5);
                gCtx.fillRect(px + 20, py + 20, 8, 5);
            }

            // Render Fireworks (if winning)
            if(gameWinSequence) {
                 for(let i = fireworkParticles.length - 1; i >= 0; i--) {
                    const p = fireworkParticles[i];
                    p.update();
                    p.draw(gCtx);
                    if(p.life <= 0) fireworkParticles.splice(i, 1);
                 }
            }

            gameFrameId = requestAnimationFrame(gameLoop);
        }
        
        function triggerWinSequence(flagObj, screenGround) {
            gameRunning = false;
            gameWinSequence = true;
            playWinSound();
            
            // Calculate Height Score (1 to 6)
            // Flag Top Y = screenGround - 200
            // Flag Bottom Y = screenGround
            // Hero Y is somewhere between. 
            // Higher logic: (screenGround - hero.y) / 200
            const flagHeight = 200;
            const hitHeight = screenGround - hero.y; // Pixels from ground
            const ratio = Math.min(Math.max(hitHeight / flagHeight, 0), 1);
            
            // Map 0.0-1.0 to 1-6 firecrackers
            const numFirecrackers = Math.floor(ratio * 5) + 1;
            
            let count = 0;
            const interval = setInterval(() => {
                // Random position near flag
                const fx = (flagObj.x - scroll) + (Math.random() - 0.5) * 200;
                const fy = (screenGround - 200) + (Math.random() * 200);
                spawnFirework(fx, fy);
                
                count++;
                if(count >= numFirecrackers) {
                    clearInterval(interval);
                    setTimeout(unlockSite, 1500); // Wait after fireworks to unlock
                }
            }, 300);
        }

        // Input
        function handleJump() {
            if(hero.grounded) { 
                hero.dy = JUMP; 
                hero.grounded = false; 
                playJumpSound();
            }
        }

        window.addEventListener('keydown', e => {
            if(!gameRunning) return;
            if((e.code === 'Space' || e.code === 'ArrowUp') && hero.grounded) handleJump();
        });
        window.addEventListener('touchstart', (e) => {
             // FIX: Allow scrolling if site is unlocked
             if(document.body.classList.contains('site-active')) return;
             
             e.preventDefault(); 
             if(!gameRunning) return;
             if(hero.grounded) handleJump();
        }, {passive: false});
        window.addEventListener('mousedown', () => {
             if(!gameRunning) return;
             if(hero.grounded) handleJump();
        });

        // Start Game
        initGame();


        /* =========================================
           PART 2: PARTICLE SYSTEM & TYPING
           ========================================= */
        
        function unlockSite() {
            gameWinSequence = false;
            cancelAnimationFrame(gameFrameId);
            document.body.classList.add('site-active');
            initParticles();
            typeWriterEffect(); // Trigger typing
        }

        // --- TYPING EFFECT ---
        function typeWriterEffect() {
            const titleEl = document.getElementById('hero-title');
            const subEl = document.getElementById('hero-subtitle');
            const titleText = "NAXXTRA";
            const subText = "PROCESS IMPROVEMENT SPECIALIST";
            
            let i = 0;
            function typeTitle() {
                if (i < titleText.length) {
                    titleEl.innerHTML += titleText.charAt(i);
                    i++;
                    setTimeout(typeTitle, 150);
                } else {
                    titleEl.classList.remove('typing-cursor'); // Stop blink on title
                    subEl.classList.add('typing-cursor'); // Start blink on sub
                    let j = 0;
                    function typeSub() {
                        if (j < subText.length) {
                            subEl.innerHTML += subText.charAt(j);
                            j++;
                            setTimeout(typeSub, 50);
                        }
                    }
                    setTimeout(typeSub, 300);
                }
            }
            typeTitle();
        }


        const pCanvas = document.getElementById('particle-canvas');
        const pCtx = pCanvas.getContext('2d');
        const gravityBtn = document.getElementById('gravity-btn');
        
        let particles = [];
        let mouse = { x: null, y: null, radius: 150 };
        let gravityEnabled = false;
        let shockwave = 0;

        gravityBtn.addEventListener('click', (e) => {
            e.stopPropagation(); 
            gravityEnabled = !gravityEnabled;
            gravityBtn.classList.toggle('active');
            particles.forEach(p => {
                p.vy = -Math.random() * 5; 
            });
        });

        class Particle {
            constructor(x, y) {
                this.x = x; this.y = y; this.baseX = x; this.baseY = y;
                this.size = Math.random() * 3 + 1;
                this.density = (Math.random() * 30) + 1;
                this.vx = 0; this.vy = 0;
                this.color = Math.random() > 0.5 ? '#38bdf8' : '#818cf8';
            }
            draw() {
                pCtx.fillStyle = document.body.classList.contains('matrix-mode') ? '#0f0' : this.color;
                pCtx.beginPath();
                pCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                pCtx.fill();
            }
            update() {
                if (gravityEnabled) {
                    this.vy += 0.5; this.y += this.vy; this.x += this.vx;
                    if (this.y + this.size > pCanvas.height) {
                        this.y = pCanvas.height - this.size; this.vy *= -0.6; this.vx *= 0.9;
                    }
                    if (this.x + this.size > pCanvas.width || this.x - this.size < 0) this.vx *= -1;
                } else {
                    let dx = mouse.x - this.x; let dy = mouse.y - this.y;
                    let distance = Math.sqrt(dx * dx + dy * dy);
                    let forceDirectionX = dx / distance; let forceDirectionY = dy / distance;
                    let maxDistance = mouse.radius + shockwave;
                    let force = (maxDistance - distance) / maxDistance;
                    let directionX = forceDirectionX * force * this.density;
                    let directionY = forceDirectionY * force * this.density;

                    if (distance < mouse.radius + shockwave) {
                        this.x -= directionX; this.y -= directionY;
                    } else {
                        if (this.x !== this.baseX) { let dx = this.x - this.baseX; this.x -= dx / 20; }
                        if (this.y !== this.baseY) { let dy = this.y - this.baseY; this.y -= dy / 20; }
                    }
                }
            }
        }

        function initParticles() {
            pCanvas.width = window.innerWidth;
            pCanvas.height = window.innerHeight;
            particles = [];
            const numberOfParticles = (pCanvas.width * pCanvas.height) / 8000;
            for (let i = 0; i < numberOfParticles; i++) {
                particles.push(new Particle(Math.random() * pCanvas.width, Math.random() * pCanvas.height));
            }
            animateParticles();
        }

        function animateParticles() {
            pCtx.clearRect(0, 0, pCanvas.width, pCanvas.height);
            for (let i = 0; i < particles.length; i++) {
                particles[i].draw(); particles[i].update();
            }
            if (!gravityEnabled) connectParticles();
            if(shockwave > 0) shockwave -= 5;
            requestAnimationFrame(animateParticles);
        }

        function connectParticles() {
            let opacityValue = 1;
            for (let a = 0; a < particles.length; a++) {
                for (let b = a; b < particles.length; b++) {
                    let dx = particles[a].x - particles[b].x;
                    let dy = particles[a].y - particles[b].y;
                    let distance = dx * dx + dy * dy;
                    if (distance < 3600) { 
                        opacityValue = 1 - (distance / 3600);
                        pCtx.strokeStyle = document.body.classList.contains('matrix-mode') ? 
                            'rgba(0, 255, 0,' + opacityValue + ')' : 
                            'rgba(148, 163, 184,' + opacityValue + ')';
                        pCtx.lineWidth = 1;
                        pCtx.beginPath();
                        pCtx.moveTo(particles[a].x, particles[a].y);
                        pCtx.lineTo(particles[b].x, particles[b].y);
                        pCtx.stroke();
                    }
                }
            }
        }

        window.addEventListener('mousemove', (e) => { mouse.x = e.x; mouse.y = e.y; });
        window.addEventListener('touchmove', (e) => { mouse.x = e.touches[0].clientX; mouse.y = e.touches[0].clientY; });
        window.addEventListener('click', (e) => {
            if (e.target.tagName !== 'A' && e.target.tagName !== 'BUTTON' && !e.target.closest('a') && !e.target.closest('button')) {
                shockwave = 200; setTimeout(() => shockwave = 0, 500);
            }
        });
        window.addEventListener('resize', () => {
            pCanvas.width = window.innerWidth; pCanvas.height = window.innerHeight;
            pCanvas.style.height = window.innerHeight + 'px';
        });

    })(); // End IIFE
    </script>
</body>
</html>
